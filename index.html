---
layout: document.njk
---

<h1>Hexcolor Words</h1>
<button class="dark-toggle" id="darkToggle" aria-label="Toggle dark mode" style="position:fixed;top:1rem;right:1rem;z-index:2000;">🌙</button>

<div class="search-container">
  <label for="searchInput"
    >Search {{colors.length}} colors by name or hex</label
  >
  <div
    style="
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      align-items: center;
    "
  >
    <input type="text" id="searchInput" class="search-input" />
    <button type="button" id="clearSearchBtn" class="search-clear-btn">
      Clear
    </button>
  </div>
</div>
<button id="openModalBtn" style="margin: 2rem auto; display: block">
  Suggest a missing color
</button>
<div class="modal" id="suggestModal">
  <div class="modal-content">
    <button class="close" id="closeModalBtn" aria-label="Close">&times;</button>
    <h2>Suggest a missing color</h2>
  <form id="suggestColorForm">
      <div>
        <label for="suggestHex">Hex code:</label>
        <input
          type="text"
          id="suggestHex"
          name="hex"
          required
          pattern="#?[A-Fa-f0-9]{6}"
        />
      </div>
      <div>
        <label for="suggestName">Name:</label>
        <input type="text" id="suggestName" name="name" required />
      </div>
      <div>
        <label for="suggestUrl">URL:</label>
        <input type="url" id="suggestUrl" name="url" required />
      </div>
      <button type="submit">Submit</button>
      <div style="margin-top:1rem;text-align:center">
        <a href="https://github.com/svillegascreative/hexcolor-words/compare/main...main?expand=1" target="_blank" rel="noopener" style="color:inherit;text-decoration:underline;font-size:0.95em;">Prefer GitHub? Create a pull request directly</a>
      </div>
    </form>
  </div>
</div>

<ul class="grid">
  {% for color in colors %}
  <li>
    <article class="color-block" style="background:{{ color.hex }}">
      <span class="hex">{{ color.hex }}</span>
      <a href="{{ color.url }}" target="_blank" class="name"
        >{{ color.name }}</a
      >
    </article>
  </li>
  {% endfor %}
</ul>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Dark mode setup
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const darkToggle = document.getElementById('darkToggle');
    function setDarkMode(on) {
      document.body.classList.toggle('dark-mode', on);
      document.querySelectorAll('.modal').forEach(m => m.classList.toggle('dark-mode', on));
      document.querySelectorAll('.color-block').forEach(cb => cb.classList.toggle('dark-mode', on));
      darkToggle.textContent = on ? '☀️' : '🌙';
      localStorage.setItem('darkMode', on ? '1' : '0');
    }
    // Initial mode
    const saved = localStorage.getItem('darkMode');
    setDarkMode(saved ? saved === '1' : prefersDark);
    darkToggle.addEventListener('click', () => {
      setDarkMode(!document.body.classList.contains('dark-mode'));
    });
  const input = document.getElementById("searchInput");
    input.addEventListener("input", function (e) {
      const val = e.target.value.toLowerCase();
      document.querySelectorAll(".grid > li").forEach((block) => {
        const hex = block.querySelector(".hex").textContent.toLowerCase();
        const name = block.querySelector(".name").textContent.toLowerCase();
        if (hex.startsWith(val) || name.startsWith(val) || val === "") {
          block.classList.remove("hide");
        } else {
          block.classList.add("hide");
        }
      });
    });

    const clearSearchBtn = document.getElementById("clearSearchBtn");
    const searchInput = document.getElementById("searchInput");
    clearSearchBtn.addEventListener("click", function () {
      searchInput.value = "";
      searchInput.dispatchEvent(new Event("input"));
      searchInput.focus();
    });

    const openModalBtn = document.getElementById("openModalBtn");
    const closeModalBtn = document.getElementById("closeModalBtn");
    const suggestModal = document.getElementById("suggestModal");

    openModalBtn.addEventListener("click", () => {
      suggestModal.classList.add("active");
    });
    closeModalBtn.addEventListener("click", () => {
      suggestModal.classList.remove("active");
    });
    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        suggestModal.classList.remove("active");
      }
    });
    suggestModal.addEventListener("click", (e) => {
      if (e.target === suggestModal) {
        suggestModal.classList.remove("active");
      }
    });

    const suggestForm = document.getElementById("suggestColorForm");
    suggestForm.addEventListener("submit", async function (e) {
      e.preventDefault();
      const hex = document.getElementById("suggestHex").value.trim();
      const name = document.getElementById("suggestName").value.trim();
      const url = document.getElementById("suggestUrl").value.trim();
      const btn = suggestForm.querySelector('button[type="submit"]');
      // Check for duplicate name (case-insensitive)
      const existingNames = Array.from(document.querySelectorAll('.grid .name')).map(a => a.textContent.trim().toLowerCase());
      if (existingNames.includes(name.toLowerCase())) {
        alert("That word already exists in the color list.");
        return;
      }
      btn.disabled = true;
      btn.textContent = "Submitting...";
      try {
        const res = await fetch(
          "https://hexcolor-words.netlify.app/.netlify/functions/suggest-color",
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ hex, name, url }),
          }
        );
        const data = await res.json();
        if (res.ok && data.pr_url) {
          alert(
            "Thank you! Your suggestion was submitted.\nPull request: " +
              data.pr_url
          );
          suggestForm.reset();
          document.getElementById("suggestModal").classList.remove("active");
        } else {
          alert("Error: " + (data.message || "Could not create pull request."));
        }
      } catch (err) {
        alert("Network error: " + err.message);
      }
      btn.disabled = false;
      btn.textContent = "Submit";
    });
  });

</script>

<footer style="margin-top:3rem;padding:2rem 0;text-align:center;font-size:1rem;color:#888;">
  <div>
    Created with <a href="https://github.com/features/copilot" target="_blank" rel="noopener" style="color:inherit;text-decoration:underline;">Copilot</a> by <a href="https://github.com/svillegascreative" target="_blank" rel="noopener" style="color:inherit;text-decoration:underline;">svillegascreative</a>.<br>
    Hosted on <a href="https://www.netlify.com/" target="_blank" rel="noopener" style="color:inherit;text-decoration:underline;">Netlify</a>.<br>
    <a href="https://github.com/svillegascreative/hexcolor-words" target="_blank" rel="noopener" style="color:inherit;text-decoration:underline;">GitHub Repo</a>
  </div>
</footer>
